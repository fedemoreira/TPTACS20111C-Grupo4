<html>
<head>
<title>Grupo 4</title>
<link href="estilo.css" rel="stylesheet" type="text/css">
<script src="jquery.js"></script>                  
<script>
var funcionDelGet = function(data)
{
  var items = [];

  $.each(data, function(key, val) {
    items.push("<div class=\"cat\" idCat=\"" + val.id + "\">" + val.name + "</div>");
  });

  $('<ul/>', {
    'class': 'categorias',
    html: items.join('\n')
  }).appendTo('.listaDeCategorias');
        $.each(datos.path_from_root, function(key, data)
        {
          $("<div class=\'pater\' idCat=\'" + data.id + "\'>" + data.name +  "</div>").appendTo('.pathToRoot');
        });
};

var funcionDelGetSecundario = function(datos)
{	
	var items = [];
    $(".pathToRoot").empty();
     $.each(datos.children_categories, function(keychildren, valchildren) {
    items.push("<div class=\"cat\" idCat=\"" + valchildren.id + "\">" + valchildren.name + "</div>");
});
    $('<ul/>', {
        'class': 'categorias',
        html: items.join('\n')
        }).appendTo('.listaDeCategorias');
        $.each(datos.path_from_root, function(key, data)
        {
          $("<div class=\'pater\' idCat=\'" + data.id + "\'>" + data.name +  "</div>").appendTo(".pathToRoot");
        });
};

$.getJSON("ServletMercadoLibre", function(data) {
	funcionDelGet(data);
});
</script>


<script>
$(".cat").live('click', function() {
	var url = "ServletMercadoLibre?cat=" + $(this).attr("idCat");
        $(".pathToRoot").empty();
	$(".listaDeCategorias").empty();
	$.getJSON(url, function(datos) {
		funcionDelGetSecundario(datos);
		});	
	});
</script>
<script>
$(".pater").live('click', function() {
	$(".cat").slideUp();
        $(".pathToRoot").empty();
	$(".listaDeCategorias").empty();
        var url = "ServletMercadoLibre?cat=" + $(this).attr("idCat");
	$.getJSON(url, function(datos) {
		funcionDelGetSecundario(datos);
		});	

	});
</script>

</head>

<body>
Categorias visitadas:
<div class = pathtoRoot></div>

Seleccione una categoria:
<div class = listaDeCategorias></div>
</body>
</html>
