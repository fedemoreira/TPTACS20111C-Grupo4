<html>
<head>
<title>Grupo 4</title>
<link href="estilo.css" rel="stylesheet" type="text/css">
<script src="jquery.js"></script>                  
<script>

var regenerarPathToRoot = function(datos)
{
        $.each(datos.path_from_root, function(key, data)
        {
          $("<div class=\'cat\' idCat=\'" + data.id + "\'>" + data.name +  "</div>").appendTo('.pathToRoot');
        });
}

var regenerarCategorias = function(data)
{
  var items = [];

  $.each(data, function(key, val) {
    items.push("<div class=\"cat\" idCat=\"" + val.id + "\">" + val.name + "</div>");
  });

  $('<ul/>', {
    'class': 'categorias',
    html: items.join('\n')
  }).appendTo('.listaDeCategorias');
}

var funcionDelGet = function(datos)
{
regenerarCategorias(datos);
}

var funcionDelGetSecundario = function(datos)
{	
	var items = [];
    $(".pathToRoot").empty();
    regenerarCategorias(datos.children_categories);
regenerarPathToRoot(datos);
};

$.getJSON("ServletMercadoLibre", function(data) {
	funcionDelGet(data);
});
</script>




<script>
$(".cat").live('click', function() {
	var url = "ServletMercadoLibre?cat=" + $(this).attr("idCat");
        $(".pathToRoot").empty();
	$(".listaDeCategorias").empty();
	$.getJSON(url, function(datos) {
		funcionDelGetSecundario(datos);
		});	
	});
</script>

</head>

<body>
Categorias visitadas:
<div class = pathtoRoot></div>

Seleccione una categoria:
<div class = listaDeCategorias></div>
</body>
</html>
